<view class="outer">
  <view style="padding:30rpx">
    <view style="display: flex;flex-direction: row;width: 670rpx;justify-content:space-between;">
      <view style="display: flex;flex-direction: row;">
        <image src="{{preURL + postDetail.user_avatar}}.svg" style="width: 80rpx;height: 80rpx;"></image>
        <view style="margin-left: 20rpx;">
          <view style="font-size: 32rpx;font-weight: bold;">#{{postDetail.post_id}}</view>
          <view style="font-size: 26rpx;color: #8C8C8C;">{{postDetail.post_topic}}</view>
        </view>
      </view>
      <view style="display: flex;flex-direction: row;height: 40rpx;align-self: center;right: 30rpx;position: relative;">
        <image src="/images/sf-star.svg" style="width: 30rpx;height: 30rpx;padding-right: 15rpx;margin-top: 6rpx;"></image>
        <view style="color: #8C8C8C;font-weight: bold;padding-right: 25rpx;font-size: 30rpx;">{{postDetail.follower_num}}</view>
        <image src="/images/sf-comment.svg" style="width: 30rpx;height: 30rpx;padding-right: 15rpx;margin-top: 6rpx;"></image>
        <view style="color: #8C8C8C;font-weight: bold;font-size: 30rpx;padding-right: 20rpx;">{{postDetail.comment_num}}</view>
      </view>
    </view>
    <view class="divider1"></view>
    <text style="font-size: 30rpx;">{{postDetail.post_msg}}</text>

    <view wx:if="{{postDetail.post_image != ''}}" style="margin-top: 20rpx;text-align:center">
      <image style="width:100%;border-radius: 10px" mode="widthFix" src="{{postDetail.post_image}}" bindtap="previewPic"></image>
    </view>

    <!-- Bilibili -->
    <view class="function_container" style="height: 150rpx;  flex-direction: row;" wx:if="{{postDetail.post_media.media_type == 'bilibili'}}" bindtap="onTapBilibili">
      <image class="function_bilibili_image" mode="aspectFill" src="{{postDetail.post_media.bilibili_image}}"></image>
      <view class="function_bilibili_right">
        <view class="function_text_container">
          <view class="function_text_title">{{postDetail.post_media.bilibili_title}}</view>
          <view class="function_text_detail">{{postDetail.post_media.bilibili_author}}</view>
        </view>
        <image class="function_bilibili_icon" src="/images/bilibili.svg"></image>
      </view>
    </view>
    <!-- 文章 -->
    <view class="function_container" style="height: 150rpx;  flex-direction: row;" wx:if="{{postDetail.post_media.media_type == 'article'}}" bindtap="onTapArticle">
      <image class="function_bilibili_image" mode="aspectFill" src="{{postDetail.post_media.article_image}}"></image>
      <view class="function_bilibili_right">
        <view class="function_text_container">
          <view class="function_text_title">{{postDetail.post_media.article_title}}</view>
          <view class="function_text_detail">{{postDetail.post_media.article_author}}</view>
        </view>
      </view>
    </view>
    <!-- 网易云 -->
    <view class="function_container" style="height: 150rpx;  flex-direction: row;" wx:if="{{postDetail.post_media.media_type == 'netease'}}" bindtap="onTapNetease">
      <image class="function_netease_image" mode="aspectFill" src="{{postDetail.post_media.netease_image}}"></image>
      <view class="function_netease_right">
        <view class="function_text_container">
          <view class="function_text_title">{{postDetail.post_media.netease_title}}</view>
          <view class="function_text_detail">{{postDetail.post_media.netease_artist}} - {{postDetail.post_media.netease_epname}}</view>
        </view>
        <image class="function_netease_icon" src="/images/netease.svg"></image>
      </view>
    </view>
    <!-- 投票 -->
    <view class="function_container" style="padding-bottom: 20rpx;  flex-direction: column;" wx:if="{{postDetail.post_media.media_type == 'vote'}}">
      <view class="function_vote_title">{{postDetail.post_media.vote_title}}</view>
      <view class="function_vote_subtitle" wx:if="{{postDetail.post_media.user_voted_option_title}}">你已选择：{{postDetail.post_media.user_voted_option_title}}</view>
      <view class="function_vote_subtitle" wx:else>你尚未投票{{postDetail.post_media.user_voted_option_title}}</view>
      <view class="function_vote_option_list" wx:for="{{postDetail.post_media.optionList}}" bindtap="vote" data-optionid="{{item.option_id}}">
        <view class="function_vote_option_lower">
          <view class="{{item.is_voted ? 'function_vote_option_lower_text_left_voted' :'function_vote_option_lower_text_left'}}">{{item.option_title}}</view>
          <view class="{{item.is_voted ? 'function_vote_option_lower_text_right_voted' :'function_vote_option_lower_text_right'}}">{{item.option_num}}</view>
        </view>
        <view class="{{item.is_voted ? 'function_vote_option_upper_voted' :'function_vote_option_upper'}}" style="width:{{item.option_percentage}};">
          <view class="function_vote_option_upper_inner">
            <view class="function_vote_option_upper_text_left">{{item.option_title}}</view>
            <view class="function_vote_option_upper_text_right">{{item.option_num}}</view>
          </view>
        </view>
      </view>

    </view>
    <!-- 引用树洞 -->
    <view class="function_container" style="height: 150rpx;  flex-direction: row;" wx:if="{{postDetail.post_media.media_type == 'quote'}}" bindtap="onTapQuote">
      <image class="function_netease_image" mode="aspectFill" src="/images/pootal-logo.svg"></image>
      <view class="function_netease_right">
        <view class="function_text_container">
          <view class="function_text_title">{{postDetail.post_media.quote_title}}</view>
          <view class="function_text_detail_quote">{{postDetail.post_media.quote_content}}</view>
        </view>
      </view>
    </view>
    <!-- 小程序 -->
    <view class="function_container" style="height: 150rpx;  flex-direction: row;" wx:if="{{postDetail.post_media.media_type == 'miniapp'}}" bindtap="onTapMiniapp">
      <image class="function_netease_image" mode="aspectFill" src="{{postDetail.post_media.miniapp_image}}"></image>
      <view class="function_netease_right">
        <view class="function_text_container">
          <view class="function_text_title">{{postDetail.post_media.miniapp_msg}}</view>
          <view class="function_text_detail_quote">{{postDetail.post_media.miniapp_name}}</view>
        </view>
      </view>
    </view>

    <view style="margin-top:20rpx;display: flex;flex-direction: row;width: 100%">
      <view style="display: flex;flex-direction: row;position: relative;bottom: 0;"></view>
      <view style="height:40rpx;width: 40rpx;">
      <image style="display: inline;" src="/images/sf-comment.svg"></image>
    </view>
      <image style="height:40rpx;width: 60rpx;margin-left: 30rpx;" src="/images/sf-star.svg"></image>
      <image style="height:40rpx;width: 44rpx;margin-left: 30rpx" src="/images/sf-share.svg"></image>
      <image style="height:40rpx;width: 60rpx;margin-left: 30rpx" src="/images/sf-warning.svg"></image>
      <view style="width: 100%;">
        <view style="text-align: right;color: #8C8C8C;font-size: 30rpx;" wx:if="{{postDetail.post_school_label == 'CUHK' || postDetail.post_school_label == 'UST'}}">来自UNI</view>
        <view style="text-align: right;color: #8C8C8C;font-size: 30rpx;" wx:if="{{postDetail.post_school_label == 'HKU'}}">已同步至UNI</view>
        <view style="text-align: right;color: #8C8C8C;font-size: 30rpx;">{{postDetail.post_date}}</view>
      </view>
    </view>
  </view>
</view>

<view style="width: 670rpx;background-color: var(--divider);display: flex;flex-direction: row;padding: 20rpx 40rpx;justify-content: space-between;font-size: 28rpx;color: #8C8C8C;font-weight: bold;">
  <view>评论 {{postDetail.comment_num}}</view>
  <view style="display: flex;flex-direction: row;">
    <view>倒序查看</view>
    <image style="width: 20rpx;height: 26rpx;margin-left: 10rpx;margin-top: 6rpx;" src="/images/sf-top.svg"></image>
  </view>
</view>

<view style="padding: 40rpx;">
  <view style="margin-bottom: 20rpx;" wx:for="{{commentList}}">
    <view style="display: flex;flex-direction: row;width: 670rpx;margin-bottom: 20rpx;">
      <image src="{{preURL + item.user_avatar}}.svg" style="width: 60rpx;height: 60rpx;"></image>
      <view style="margin-left: 20rpx;width: 570rpx;">
        <view style="justify-content:space-between;display: flex;flex-direction: row;">
          <view style="font-size: 30rpx;font-weight: bold;">{{item.comment_alias}}</view>
          <view style="font-size: 28rpx;color: #8C8C8C;"><text wx:if="{{item.comment_order == 0}}">G</text><text wx:else>LG{{item.comment_order}}</text><text> · {{item.comment_date}}</text></view>
        </view>
        <text style="font-size: 28rpx;margin-top:10rpx">{{item.comment_msg}}</text>
      </view>
    </view>
    <view class="divider2" wx:if="{{commentList[index+1]}}"></view>
  </view>
</view>